---
title: 设计模式-享元模式
abbrlink: 2031750427
date: 2019-12-22 08:26:58
categories:
  - 设计模式
tags:
  - 设计模式
author: 长歌
---
{% cq %}
享元模式(Flyweight Pattern)主要用于减少创建对象的数量，以减少内存占用和提高性能。这种类型的设计模式属于结构型模式，它提供了减少对象数量从而改善应用所需的对象结构的方式。
{% endcq %}
<!-- More -->

## Diagram
{% asset_img 享元模式.png 享元模式UML图 %}

## Implementation
### 享元接口
```java
public interface Flyweight  {
    void doOperation(String extrinsicState);
}
```
### 享元实例
```java
public class ConcreteFlyweight implements Flyweight{

    private String intrinsicState;

    public ConcreteFlyweight(String intrinsicState) {
        this.intrinsicState = intrinsicState;
    }

    @Override
    public void doOperation(String extrinsicState) {
        System.out.println("Object address: " + System.identityHashCode(this));
        System.out.println("IntrinsicState: " + intrinsicState);
        System.out.println("ExtrinsicState: " + extrinsicState);
    }
}

```
### 享元工厂类
```java
public class FlyweightFactory {

    private HashMap<String,Flyweight> flyweightHashMap = new HashMap<>();


    Flyweight getFlyweight(String intrinsicState){
        if(!flyweightHashMap.containsKey(intrinsicState)){
            Flyweight flyweight = new ConcreteFlyweight(intrinsicState);
            flyweightHashMap.put(intrinsicState,flyweight);
        }
        return flyweightHashMap.get(intrinsicState);
    }
}

```
### 测试类
```java
public class FlyweightTest {

    @Test
    public void test() {
        FlyweightFactory factory = new FlyweightFactory();
        Flyweight flyweight1 = factory.getFlyweight("aa");
        Flyweight flyweight2 = factory.getFlyweight("aa");
        flyweight1.doOperation("x");
        flyweight2.doOperation("y");
    }
}
```

## Example
> Java 利用缓存来加速大量小对象的访问时间。
- java.lang.Integer#valueOf(int)
- java.lang.Boolean#valueOf(boolean)
- java.lang.Byte#valueOf(byte)
- java.lang.Character#valueOf(char)

## Reflence
- [<大话设计模式>](https://book.douban.com/subject/2334288/)
- [设计模式 | 菜鸟教程](https://www.runoob.com/design-pattern/design-pattern-tutorial.html)
- [Github | CyC2018](https://github.com/CyC2018/CS-Notes/blob/master/notes/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20-%20%E7%9B%AE%E5%BD%95.md)